version: "3.8"

# Dev-specific overrides â€” applied automatically by docker compose
services:
  opsai-bot:
    build:
      target: dev
    environment:
      - LOG_LEVEL=debug
      - DEV_MODE=true
    # Bind-mount source for hot-reload (requires air or similar watcher in Dockerfile dev stage)
    volumes:
      - .:/app
      - ./configs:/app/configs:ro
      - opsai-data:/data

  grafana:
    environment:
      - GF_AUTH_ANONYMOUS_ENABLED=true
      - GF_AUTH_ANONYMOUS_ORG_ROLE=Admin
      - GF_USERS_DEFAULT_THEME=dark

  prometheus:
    command:
      - "--config.file=/etc/prometheus/prometheus.yml"
      - "--storage.tsdb.retention.time=1d"
      - "--web.enable-lifecycle"
